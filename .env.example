# ===========================================
# EditShare Manager - Environment Configuration
# ===========================================
# Copy this file to .env and adjust values
#
# DEPLOYMENT: This app runs directly on the EditShare server
# (192.168.178.191) to access native EFS CLI tools.

# --- EditShare API Connection ---
# When deployed on the ES server, use localhost
ES_HOST=localhost
ES_API_PORT=8006
ES_API_USER=editshare
ES_API_PASSWORD=changeme0479
ES_ALLOW_SELF_SIGNED=true

# --- LDAP Connection ---
# slapd runs on the same server
LDAP_URI=ldaps://localhost
LDAP_BIND_DN=cn=admin,dc=efs,dc=editshare
LDAP_BIND_PASSWORD=
LDAP_BASE_DN=dc=efs,dc=editshare
LDAP_REJECT_UNAUTHORIZED=false

# --- EFS Direct Access ---
# Native EFS mount on the EditShare server
EFS_MOUNT_POINT=/efs/efs_1
EFS_METADATA_HOST=localhost
EFS_METADATA_PORT=9421

# --- Automated Tiering ---
TIERING_ENABLED=true
TIERING_CHECK_INTERVAL_MINUTES=60
TIERING_MAX_FILES_PER_RUN=1000
TIERING_LOG_RETENTION_DAYS=30

# --- Trash (EFS snapshot-based soft delete) ---
TRASH_ENABLED=true
TRASH_RETENTION_DAYS=30
TRASH_PURGE_INTERVAL_MINUTES=60

# --- Asset Catalog ---
CATALOG_SCAN_ENABLED=true
CATALOG_SCAN_INTERVAL_MINUTES=60
CATALOG_MAX_CHECKSUM_FILES_PER_SCAN=200
CATALOG_DATA_PATH=/efs/efs_1/editshare/catalog

# --- QoS History & Scheduling ---
QOS_HISTORY_ENABLED=true
QOS_HISTORY_POLL_INTERVAL_SECONDS=30
QOS_HISTORY_RETENTION_DAYS=7

# --- Guardian Log Receiver ---
# Receives events from EFS Control / Guardian (OpenSearch stack).
# Configure the Guardian external endpoint to point to this host:port.
# Protocols: elasticsearch (recommended, HTTP bulk JSON), logstash (HTTP JSON), syslog (TCP)
# IMPORTANT: Set the Guardian endpoint protocol to "Elasticsearch" â€” "Logstash"
# uses Filebeat's Lumberjack binary protocol which requires a Logstash server.
GUARDIAN_RECEIVER_ENABLED=false
GUARDIAN_RECEIVER_PORT=15750
GUARDIAN_RECEIVER_PROTOCOL=elasticsearch
GUARDIAN_RECEIVER_USER=guardian
GUARDIAN_RECEIVER_PASSWORD=guardian15750
GUARDIAN_EVENT_RETENTION_DAYS=30
# Worker mode: 'local' processes inline (default), 'queue' enqueues for workers
GUARDIAN_WORKER_MODE=local
GUARDIAN_QUEUE_RETENTION_HOURS=24

# --- Worker API ---
# Set a shared secret to enable worker nodes for distributed processing.
# Workers use this key to authenticate: Authorization: Worker <key>
# Leave empty to disable the worker API.
WORKER_API_KEY=

# --- Application ---
APP_PORT=15700
APP_SECRET=change-this-to-a-random-secret-in-production
JWT_EXPIRY=24h

# --- Nginx (serves frontend static files, proxies /api to backend) ---
NGINX_PORT=15710

# --- Frontend (Vite dev server - local development only) ---
VITE_DEV_PORT=15720
VITE_API_BASE_URL=http://localhost:15700

# --- Docker Ports (optional, if using docker-compose instead) ---
DOCKER_BACKEND_PORT=15700
DOCKER_FRONTEND_PORT=15710
DOCKER_DEV_FRONTEND_PORT=15720
DOCKER_DEBUG_PORT=15730
